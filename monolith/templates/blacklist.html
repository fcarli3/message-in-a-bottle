<html>

<head>
  <title>Blacklist</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <style>
    body {
      background-image: url(https://i.postimg.cc/YSgCg909/mare2.jpg);
      background-size: cover;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light" style="background-color:#FFFFFF;">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><img src="https://i.postimg.cc/02vWGMHK/logo.jpg" width="30" height="30"
          alt=""></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/message/recipients">New Message</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/mailbox/received">Inbox</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/mailbox/sent">Outbox</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/mailbox/draft">Drafts</a>
          </li>
          <li class="nav-item">
            <a href="/userinfo" class="nav-link" style="color: #89A8C4;"><b>{{current_user.firstname}}</b></a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <h2>Blacklist</h2>
    <br>
    {% if blacklist %}
    <form method="delete" action="/blacklist" class="inline">
      <table class="table table-striped" style="background-color: aliceblue;">
        <thead>
          <tr>
            <th></th>
            <th>Email</th>
            <th>Firstname</th>
            <th>Lastname</th>
          </tr>
        </thead>
        <tbody>
          {% for i in blacklist %}
          <tr>
            <td><input class="form-check-input" type="radio" name="radioEmail" value={{ i[1].email }}>
            </td>
            <td>{{ i[1].email }}</td>
            <td>{{ i[1].firstname }}</td>
            <td>{{ i[1].lastname }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <button type="submit" onclick="delete_request()" role="button" class="btn mt-2"
        style="background-color: #D35E5E;">Remove</a>
    </form>
    {% else %}
    <p>No users in blacklist !</p>
    {% endif %}
  </div>
</body>

<script>
  function easyHTTP() {
    // Initialising new XMLHttpRequest method.
    this.http = new XMLHttpRequest();
  }

  // Make an HTTP Delete Request
  easyHTTP.prototype.delete
    = function (url, callback) {

      this.http.open("DELETE", url, true);

      // Assigning this to self to have
      // scope of this into the function
      let self = this;

      // When the response is ready
      this.http.onload = function () {

        // Checking status
        if (self.http.status === 200) {

          // Callback function (Error, response text)
          callback(null, "Post Deleted");
        } else {

          // Callback function (Error message)
          callback("Error: " + self.http.status);
        }
      };

      // Send the request
      this.http.send();
    };

  function delete_request() {
    // Instantiate easyHTTP
    const http = new easyHTTP();

    // Use the delete prototype
    // method with (URL, callback(error, response text))
    http.delete('/blacklist',
      function (err, response) {
        if (err) {
          console.log(err);
        } else {
          console.log(response);
        }
      });
  };



</script>

</html>